<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Stops</title>

  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script src="stopsDataService.js"></script>
  <script src="stopsViewModel.js"></script>

</head>

<body style="background-color: black; color: white; font-family: sans-serif; padding: 20px;">
  <div x-data="stopsViewModel()" x-init="getStops()">

    <h1 x-text="route"></h1>

    <template x-for="subroute in subroutes">
      <div style="margin-bottom: 20px;">
        <h2 x-text="subroute.description"></h2>

        <select x-model="subroute.selectedStopNum" @change="getNextBusInfo(subroute)" style="margin-bottom: 8px;">
          <option>Select a stop</option>
          <template x-for="stop in subroute.stops" :key="stop.number">
            <option x-text="`${stop.number} - ${stop.name}`" :value="stop.number">
            </option>
          </template>
        </select>

        <span x-text="subroute.loading ? ' â€¦getting details' : ''"></span>

        <div style="height: 100px; margin-top: 20px;">
          <template x-if="subroute.selectedStop">
            <div>
              <div x-show="subroute.selectedStop.nextBusInfo.isAvailable">
                Next bus on
                <span x-text="subroute.selectedStop.nextBusInfo.dayOfWeek"></span>
                <span x-text="subroute.selectedStop.nextBusInfo.date"></span> at
                <div x-text="subroute.selectedStop.nextBusInfo.time" style="font-size: 72px;"></div>
              </div>

              <div x-show="!subroute.selectedStop.nextBusInfo.isAvailable">
                <span x-text="subroute.selectedStop.nextBusInfo.message || 'unable to get stop data'"></span>
              </div>
            </div>
          </template>
        </div>

      </div>
    </template>

  </div>
</body>
</html>